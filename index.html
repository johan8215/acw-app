<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Allston Car Wash</title>
  <link rel="stylesheet" href="style.css">
  <script src="config.js"></script>
  <script src="app.js"></script>
</head>
<body>
  <div class="container">

    <!-- üßº LOGO / T√çTULO -->
    <h1>ALLSTON CAR WASH</h1>
    <p id="activeWeek" style="text-align:center; color:#b7c9eb; font-size:14px;">Loading current week...</p>

    <!-- üîê LOGIN -->
    <div id="login">
      <input type="email" id="email" placeholder="Email">
      <input type="password" id="password" placeholder="Password">
      <button onclick="loginUser()">Sign In</button>
    </div>

    <!-- üëã WELCOME -->
    <div id="welcome" style="display:none;">
      <h2>Welcome, <span id="userName"></span></h2>
      <p>Role: <span id="userRole"></span></p>

      <!-- ‚öôÔ∏è SETTINGS BUTTON (top corner) -->
      <div style="position:absolute; top:20px; right:25px;">
        <button onclick="toggleSettings()">‚öôÔ∏è Settings</button>
      </div>

      <!-- üîß SETTINGS PANEL (hidden by default) -->
      <div id="settingsPanel" class="settings-container" style="display:none;">
        <h3>‚öôÔ∏è Settings</h3>

        <label for="newPassword">New Password:</label>
        <input type="password" id="newPassword" placeholder="Enter new password">

        <label for="confirmPassword">Confirm Password:</label>
        <input type="password" id="confirmPassword" placeholder="Confirm password">

        <button onclick="changeUserPassword()">Change Password</button>
        <button onclick="logoutUser()" style="background:linear-gradient(145deg,#ff4444,#cc0000);margin-top:8px;">Logout</button>

        <p id="settingsMsg"></p>
      </div>

      <!-- üìÖ SCHEDULE -->
      <div id="schedule"></div>
    </div>

  </div>

  <script>
    /* ===========================================================
       üóìÔ∏è Mostrar semana activa al cargar login
       =========================================================== */
    window.addEventListener("load", async () => {
      const label = document.getElementById("activeWeek");
      try {
        const res = await fetch(`${CONFIG.BASE_URL}?action=getActiveWeek`);
        const data = await res.json();
        if (data.week) label.textContent = `üìÖ Active Week: ${data.week}`;
        else label.textContent = "No active week found";
      } catch (err) {
        label.textContent = "Unable to load week";
      }
    });
  </script>
</body>
</html>
